{{define "body"}}

<div class="pure-u-1">
	<h1>MPD Library</h1>
</div>

{{if .Error}}
<div class="pure-u-1" id="error-msg-box">
	<div class="warnings">
		<p id="error-msg"></p>
	</div>
</div>

{{else}}

<div class="pure-u-1">
	<section>
		<h2>{{if .Path}}{{.Path}}{{else}}Library{{end}}</h2>
		{{$path := .Path}}
		{{$ml := namedurl "mpd-library"}}
		<p>
			{{if .Path}}
			<a class="pure-button" href="{{$ml}}?a=up&p={{$path}}">Go Up</a>
			{{end}}
		</p>
		<table class="pure-table">
			<thead>
				<tr>
					<th>Name</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
			{{range .Folders}}
				<tr>
					<td><a href="{{$ml}}?p={{$path}}/{{.}}">[ {{.}} ]</a></td>
					<td>
						<a href="#" class="action" data-action="add" data-uri="{{$path}}/{{.}}">Add</a>
						| 
						<a href="#" class="action" data-action="replace" data-uri="{{$path}}/{{.}}">Replace</a>
					</td>
				</tr>
			{{end}}
			{{range .Files}}
				<tr>
					<td>{{.}}</td>
					<td>
						<a href="#" class="action" data-action="add" data-uri="{{$path}}/{{.}}">Add</a>
						|
						<a href="#" class="action" data-action="replace" data-uri="{{$path}}/{{.}}">Replace</a>
					</td>
				</tr>
			{{end}}
			</tbody>
		</table>
	</section>
</div>

<div class="pure-u-1">
	<section>
		<p>
			<a class="pure-button action" data-action="add" data-uri="{{.Path}}">Add this folder</a>
			<a class="pure-button action" data-action="replace" data-uri="{{.Path}}">Clear playlist and this folder</a>
			&nbsp;
			<a class="pure-button" href="{{namedurl "mpd-control" "action" "update"}}" onclick="return RPI.confirm()">Update Library</a></li>
		</p>
	</section>
</div>

<script src="/static/lib/jquery/jquery.tablesorter.min.js" type="text/javascript"></script>
<script src="/static/js/mpd.js" type="text/javascript" ></script>
<script type="text/javascript">
	$(function() {
		$('table').tablesorter({
			ignoreCase: true,
		});
		var ctrlUrl = "{{namedurl "mpd-control" "action" "-"}}";
		ctrlUrl = ctrlUrl.substring(0, ctrlUrl.length - 2);
		MPD.initLibraryPage(ctrlUrl, "{{namedurl "mpd-service-info"}}");
	});
</script>

{{end}}

{{end}}
