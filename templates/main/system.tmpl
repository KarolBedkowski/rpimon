{{define "body"}}

{{if .Warnings}}
<div class="pure-u-1">
	<div class="warnings">
		<section>
			<h1>Warning</h1>
			<ul>
			{{range .Warnings}}
				<li>{{.}}</li>
			{{end}}
			</ul>
		</section>
	</div>
</div>
{{end}}

<div class="pure-g-r content-ribbon">
	<section>
		<div class="pure-u-1">
			<h1>{{.BasePageContext.Hostname}}</h1>
		</div>
		<div class="pure-u-1">
				<p><label>Load:</label> {{.Load}}
				<span id="load-chart" class="chart-line" data-width="64" data-min="0" data-max="2">0</span>
				</p>
		</div>
		<div class="pure-u-1-2">
			<p><label>Uptime:</label> {{.Uptime}}</p>
		</div>
		<div class="pure-u-1-2">
			<p><label>Users:</label> {{.Users}}</p>
		</div>
		<div class="pure-u-1">
			<p><label>Kernel:</label> {{.Uname}}</p>
		</div>
	</section>
</div>

<div class="pure-u-1-2">
	<section>
		<h1>CPU</h1>

		<span id="cpu-chart" class="chart-line" data-width="250" data-height="50" data-min="0" data-max="100">0</span>
		<table class="pure-table table-center-align">
			<thead>
				<tr>
					<th>User</th>
					<th>System</th>
					<th>IO</th>
					<th>Freq</th>
					<th>Temp</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span id="cpuusage-user"></span>%</td>
					<td><span id="cpuusage-system"></span>%</td>
					<td><span id="cpuusage-iowait"></span>%</td>
					<td><span id="cpuinfo-freq"></span></td>
					<td><span id="cpuinfo-temp"></span>Â°C</td>
				</tr>
			</tbody>
		</table>
	</section>
</div>

<div class="pure-u-1-2">
	<section>
		<h1>Memory</h1>
		<span id="mem-chart" class="chart-line" data-width="250" data-height="50" data-min="0" data-max="100">0</span>
		<table class="pure-table">
			<thead>
				<tr>
					<th>User</th>
					<th>Buffers</th>
					<th>Cache</th>
					<th>Swap Used</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span id="meminfo-used"></span>%</td>
					<td><span id="meminfo-buff"></span>%</td>
					<td><span id="meminfo-cach"></span>%</td>
					<td><span id="meminfo-swap"></span>%</td>
				</tr>
			</tbody>
		</table>
	</section>
</div>

<div class="pure-u-1-2">
	<section>
		<h1>Mount</h1>
		<table class="pure-table">
			<thead>
				<tr>
					<th>Filesystem</th>
					<th colspan="2">Used</th>
				</tr>
			</thead>
			{{range .Filesystems}}
			<tr>
				<td>{{.MountPoint}}</td>
				<td><span class="pie" data-diameter="32" data-colours='["red", "#f0f0f0"]'>{{.UsedPerc}}/100</span></td>
				<td>{{.UsedPerc}}%</td>
			</tr>
			{{end}}
		</table>
	</section>
</div>

<div class="pure-u-1-2">
	<section>
		<h1>Network interfaces</h1>
		<table class="pure-table">
			<thead>
				<tr>
					<th>Interface</th>
					<th>IP</th>
				</tr>
			</thead>
			{{range .Interfaces}}
			<tr>
				<td>{{.Name}}</td>
				<td>{{.Address}}</td>
			</tr>
			{{end}}
		</table>
	</section>
</div>

<script src="/static/lib/jquery/jquery.peity.min.js" type="text/javascript" ></script>
<script type="text/javascript">
	function refresh() {
		window.location.reload(true);
	};

	function getHistory() {
		$.ajax({
			url: '/main/info',
			cache: false,
			dataType: 'json'
		}).done(function(msg) {
			$('#load-chart').text(msg['load']).change()
			$('#cpu-chart').text(msg['cpu']).change()
			$('#mem-chart').text(msg['mem']).change()
			var meminfo = msg['meminfo'];
			$('#meminfo-used').text(meminfo['MemUsedPerc']);
			$('#meminfo-buff').text(meminfo['MemBuffersPerc']);
			$('#meminfo-cach').text(meminfo['MemCachePerc']);
			$('#meminfo-swap').text(meminfo['MemSwapUsedPerc']);
			var cpuusage = msg['cpuusage'];
			$('#cpuusage-user').text(cpuusage['CPUUser']);
			$('#cpuusage-system').text(cpuusage['CPUSystem']);
			$('#cpuusage-iowait').text(cpuusage['CPUIoWait']);
			var cpuinfo = msg['cpuinfo'];
			$('#cpuinfo-freq').text(cpuinfo['CPUFreq']);
			$('#cpuinfo-temp').text(cpuinfo['CPUTemp']);
			setTimeout(getHistory, 1000);
		});
	}

	$(function() {
		$("span.pie").peity("pie")
		$("span.chart-line").peity("line")
		getHistory();
	});
</script>

{{end}}
